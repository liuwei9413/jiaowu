webpackJsonp([28],{214:function(t,e,n){n(349);var a=n(73)(n(269),n(395),null,null);t.exports=a.exports},269:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"subjectManagement",data:function(){return{fullscreenLoading:!1,schoolId:"1",gradeId:"1",subjectState:!0,currentGradeId:"1",teachers:[],grades:[],dialogVisibleEditTeacher:!1,dialogVisibleAddSubject:!1,teacherEdit:{},currentTeacherId:"",subjects:[],subjectsLenght:"",oldSubjectsLenght:"",subjectId:"",classId:"",teacherId:"",adddSubjectId:"",teachingInfo:"",subjectInfo:"",SubjectDBs:[]}},mounted:function(){this.getGrade(),this.getSubjects(),this.getTeacher(),this.getTeaching()},methods:{getTeacher:function(){var t=this,e={schoolId:this.schoolId};this.$ajax("/schadmin/getTeacherBySchoolId",e).then(function(e){t.teachers=e.data}).catch(function(){})},getCurrentGradeId:function(t){this.currentGradeId=t,this.getTeaching()},getGrade:function(){var t=this,e={schoolId:this.schoolId};this.$ajax("/headteacher/findGradeByCurrentUser",e).then(function(e){t.grades=e.data}).catch(function(){})},getSubjects:function(){var t=this,e={schoolId:this.schoolId,gradeId:this.currentGradeId};this.$ajax("/schadmin/findSubjectBySchoolIdAndGradeId",e).then(function(e){t.subjects=e.data}).catch(function(){})},getTeaching:function(){var t=this,e={gradeId:this.currentGradeId};this.$ajax("/teacher/findTeaching",e).then(function(e){t.teachingInfo=e.data,t.subjectInfo=t.teachingInfo[0].subjectInfo,t.oldSubjectsLenght=t.subjectsLenght,t.subjectsLenght=t.subjectInfo.length}).catch(function(){})},getTarget:function(t,e){console.log(t,e),this.currentTeacherId=e.teachingInfo.teacherName,this.classId=t.classId,this.subjectId=e.subjectId,this.dialogVisibleEditTeacher=!0},teacherSaveData:function(){var t=this,e={classId:this.classId,subjectId:this.subjectId,teacherId:this.currentTeacherId};this.$ajax("/schadmin/saveOrUpdateClassTeacherSubject",e).then(function(e){200==e.code?(t.$message({type:"success",message:"添加成功!"}),t.getTeaching(),t.dialogVisibleEditTeacher=!1):(t.$message({type:"error",message:e.message}),t.dialogVisibleAddSubject=!0)}).catch(function(){})},getSubjectDB:function(){var t=this,e={schoolId:this.schoolId,gradeId:this.currentGradeId};this.$ajax("/schadmin/findSubjectDBBySchoolIdAndGradeId",e).then(function(e){t.SubjectDBs=e.data}).catch(function(){})},addNewSubject:function(){this.dialogVisibleAddSubject=!0,this.adddSubjectId="",this.getSubjectDB()},addNewSubjectData:function(){var t=this,e={schoolId:this.schoolId,gradeId:this.currentGradeId,subjectId:this.adddSubjectId};this.$ajax("/schadmin/saveSchoolGradeSubject",e).then(function(e){200==e.code?(t.$message({type:"success",message:"添加成功!"}),t.dialogVisibleAddSubject=!1,t.getTeaching()):(t.$message({type:"error",message:e.message}),t.dialogVisibleAddSubject=!1)}).catch(function(){})},deleteSubject:function(t){function e(t){for(var e in t)return!1;return!0}for(var n=this,a=[],c=[],i=0;i<this.teachingInfo.length;i++)for(var s=0;s<this.teachingInfo[i].subjectInfo.length;s++)a.push(this.teachingInfo[i].subjectInfo[s]);c=a.filter(function(e){return e.subjectId==t.subjectId}),!function(){for(var t=0;t<c.length;t++)if(!e(c[t].teachingInfo)&&0!=c[t].teachingInfo.teacherId)return!0;return!1}()?this.$confirm("是否要删除当前科目?","提示",{type:"warning",confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){var e={schoolId:n.schoolId,gradeId:n.currentGradeId,subjectId:t.subjectId};n.$ajax("/schadmin/deleteSubjectBySchoolIdAndGradeId",e).then(function(t){200==t.code?(n.$message({type:"success",message:"删除成功!"}),n.getSubjects(),n.subjectsLenght=n.subjectInfo.length,n.dialogVisibleAddSubject=!1,n.getTeaching()):(n.$message({type:"error",message:t.message}),n.dialogVisibleAddSubject=!0)}).catch(function(){})}).catch(function(){}):this.$alert("该学科下存在教师，请先情况教师学科之间的关系。","提示",{confirmButtonText:"确定"})},deleteTeacher:function(t,e){var n=this;this.$confirm("是否要删除当前教师?","提示",{type:"warning",confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){var a={classId:e.classId,subjectId:t.subjectId};n.$ajax("/schadmin/deleteClassTeacherSubjectByCondition",a).then(function(t){200==t.code?(n.$message({type:"success",message:"删除成功!"}),n.getSubjects(),n.getTeaching(),n.dialogVisibleAddSubject=!1):(n.$message({type:"error",message:t.message}),n.dialogVisibleAddSubject=!0)}).catch(function(){})}).catch(function(){})}}}},311:function(t,e,n){e=t.exports=n(182)(),e.push([t.i,'.subjectMgt-header{text-align:left;margin-top:10px}.subjectMgt-body{margin-top:10px}.subjectMgt-body-tool{text-align:right}.subjectMgt-body table{width:100%;text-align:center}.subjectMgt-body table th{text-align:center}.subjectMgt-body table td,.subjectMgt-body table th{border:1px solid #dfe6ec;height:40px}.tooltip-warp{position:relative;display:inline-block}.subjectMgt-body table td:hover .tooltip-content,.subjectMgt-body table th:hover .tooltip-content{visibility:visible;opacity:1;-webkit-transition:all .5s;transition:all .5s}.fullCell{display:block;width:100%;height:100%}.tooltip-content{font-size:12px;padding:5px;right:-70px;white-space:nowrap;z-index:1000;background:#1f2d3d;color:#fff;cursor:pointer;visibility:hidden;opacity:0}.tooltip-content,.tooltip-content:after{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.tooltip-content:after{content:"";height:0;width:0;border-width:5px;border-style:dashed solid dashed dashed;border-color:transparent #1f2d3d transparent transparent;left:-10px}',"",{version:3,sources:["E:/works/platform/yitai-educational/src/main/webapp/src/pages/front/schoolRollFiler/subjectManagement.vue"],names:[],mappings:"AACA,mBACE,gBAAiB,AACjB,eAAiB,CAClB,AACD,iBACE,eAAiB,CAClB,AACD,sBACE,gBAAkB,CACnB,AACD,uBACE,WAAY,AACZ,iBAAmB,CACpB,AACD,0BACE,iBAAmB,CACpB,AACD,oDAEE,yBAA0B,AAC1B,WAAa,CACd,AACD,cACE,kBAAmB,AACnB,oBAAsB,CACvB,AACD,kGAEE,mBAAoB,AACpB,UAAW,AACX,2BAA6B,AAC7B,kBAAoB,CACrB,AACD,UACE,cAAe,AACf,WAAY,AACZ,WAAa,CACd,AACD,iBACE,eAAgB,AAEhB,YAAa,AACb,YAAa,AACb,mBAAoB,AAIpB,aAAc,AACd,mBAAoB,AACpB,WAAY,AACZ,eAAgB,AAChB,kBAAmB,AACnB,SAAW,CACZ,AAKD,wCAlBE,kBAAmB,AAInB,QAAS,AACT,mCAAqC,AAC7B,0BAA6B,CAwBtC,AAZD,uBAEE,WAAY,AACZ,SAAU,AACV,QAAS,AACT,iBAAkB,AAClB,wCAA+C,AAC/C,yDAA+D,AAC/D,UAAY,CAIb",file:"subjectManagement.vue",sourcesContent:["\n.subjectMgt-header{\n  text-align: left;\n  margin-top: 10px;\n}\n.subjectMgt-body{\n  margin-top: 10px;\n}\n.subjectMgt-body-tool{\n  text-align: right;\n}\n.subjectMgt-body table{\n  width: 100%;\n  text-align: center;\n}\n.subjectMgt-body table th{\n  text-align: center;\n}\n.subjectMgt-body table th,\n.subjectMgt-body table td{\n  border: 1px solid #dfe6ec;\n  height: 40px;\n}\n.tooltip-warp{\n  position: relative;\n  display: inline-block;\n}\n.subjectMgt-body table th:hover .tooltip-content,\n.subjectMgt-body table td:hover .tooltip-content{\n  visibility: visible;\n  opacity: 1;\n  -webkit-transition: all 0.5s;\n  transition:all 0.5s;\n}\n.fullCell{\n  display: block;\n  width: 100%;\n  height: 100%;\n}\n.tooltip-content{\n  font-size: 12px;\n  position: absolute;\n  padding: 5px;\n  right: -70px;\n  white-space: nowrap;\n  top: 50%;\n  -webkit-transform: translate(0,-50%);\n          transform: translate(0,-50%);\n  z-index: 1000;\n  background: #1f2d3d;\n  color: #fff;\n  cursor: pointer;\n  visibility: hidden;\n  opacity: 0;\n}\n/* .teacherName{\n  width: 100%;\n  height: 100%;\n} */\n.tooltip-content:after{\n  position: absolute; \n  content: ''; \n  height: 0; \n  width: 0; \n  border-width: 5px; \n  border-style: dashed solid  dashed    dashed  ;\n  border-color:  transparent #1f2d3d  transparent   transparent ;\n  left: -10px;\n  top: 50%;\n  -webkit-transform: translate(0,-50%);\n          transform: translate(0,-50%);\n}\n\n"],sourceRoot:""}])},349:function(t,e,n){var a=n(311);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n(183)("3ac7d390",a,!0)},395:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"subjectManagement"},[n("div",{staticClass:"subjectMgt-header"},[n("el-radio-group",{on:{change:function(e){t.getCurrentGradeId(t.currentGradeId)}},model:{value:t.currentGradeId,callback:function(e){t.currentGradeId=e},expression:"currentGradeId"}},t._l(t.grades,function(e,a){return n("el-radio-button",{key:a,attrs:{label:e.index}},[t._v(" "+t._s(e.name)+" ")])}))],1),t._v(" "),n("div",{staticClass:"subjectMgt-body"},[n("div",{staticClass:"subjectMgt-body-tool"},[t.subjectState?n("el-button",{attrs:{type:"success",icon:"plus"},on:{click:t.addNewSubject}},[t._v("新增科目")]):t._e()],1),t._v(" "),n("table",{staticClass:"subjectMgt-body"},[n("thead",[n("tr",[n("th",[t._v("班级")]),t._v(" "),t._l(t.subjectInfo,function(e,a){return n("th",{key:a},[n("div",{staticClass:"tooltip-warp"},[t._v("\n              "+t._s(e.subjectName)+"\n              "),n("div",{staticClass:"tooltip-content",on:{click:function(n){t.deleteSubject(e)}}},[t._v("删除科目")])])])})],2)]),t._v(" "),n("tbody",t._l(t.teachingInfo,function(e,a){return n("tr",{key:a},[n("td",[t._v(" "+t._s(e.className)+" ")]),t._v(" "),t._l(e.subjectInfo,function(a,c){return n("td",[n("div",{staticClass:"tooltip-warp",class:[{fullCell:!a.teachingInfo.teacherName}]},[n("a",{staticClass:"teacherName",class:[{fullCell:!a.teachingInfo.teacherName}],attrs:{href:"javascript:;"},on:{click:function(n){t.getTarget(e,a)}}},[t._v(t._s(a.teachingInfo.teacherName))]),t._v(" "),""!=a.teachingInfo.teacherName?n("div",{staticClass:"tooltip-content",on:{click:function(n){t.deleteTeacher(a,e)}}},[t._v("删除教师")]):t._e()])])})],2)}))])]),t._v(" "),n("el-dialog",{attrs:{title:"教师管理","close-on-click-modal":!1,size:"tiny"},model:{value:t.dialogVisibleEditTeacher,callback:function(e){t.dialogVisibleEditTeacher=e},expression:"dialogVisibleEditTeacher"}},[n("el-form",{ref:"teacherEdit",attrs:{model:t.teacherEdit,"label-width":"90px"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.currentTeacherId,callback:function(e){t.currentTeacherId=e},expression:"currentTeacherId"}},t._l(t.teachers,function(t,e){return n("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),n("span",{staticClass:"dialog-footer",slot:"footer"},[n("el-button",{attrs:{type:"info"},on:{click:function(e){t.dialogVisibleEditTeacher=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"success"},on:{click:t.teacherSaveData}},[t._v("保 存")])],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"添加科目","close-on-click-modal":!1,size:"tiny"},model:{value:t.dialogVisibleAddSubject,callback:function(e){t.dialogVisibleAddSubject=e},expression:"dialogVisibleAddSubject"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.adddSubjectId,callback:function(e){t.adddSubjectId=e},expression:"adddSubjectId"}},t._l(t.SubjectDBs,function(t,e){return n("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),t._v(" "),n("span",{staticClass:"dialog-footer",slot:"footer"},[n("el-button",{attrs:{type:"info"},on:{click:function(e){t.dialogVisibleAddSubject=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"success"},on:{click:t.addNewSubjectData}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=28.c163d557ca1ab93e07b1.js.map