webpackJsonp([16],{213:function(t,e,a){a(318);var s=a(73)(a(268),a(361),null,null);t.exports=s.exports},221:function(t,e,a){t.exports={default:a(222),__esModule:!0}},222:function(t,e,a){var s=a(10),n=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},268:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(221),n=a.n(s);e.default={name:"studentManagement",data:function(){return{fullscreenLoading:!1,schoolId:"111",dialogVisible:!1,headTeacher:{},isHeadTeacher:!0,gradeAllName:"",gradeName:"",className:"",grades:[],gradeId:"",currentRowInfo:"",classes:[],classId:"",currentClassId:"",studentGradeListsData:[],studentClassListsData:[],studentListslength:"",editStudentsListsData:[],gradesSearchText:"",classesSearchText:"",total:0,currentPage:1,gradesTotal:0,addMultipleSelection:[],removeMultipleSelection:[],addStudensState:!0,removeStudensState:!0,saveStudensState:!0}},mounted:function(){this.getGrade(this.gradeId),this.getSutdentGradeLists(this.gradeId)},methods:{getGrade:function(){var t=this,e={schoolId:this.schoolId};this.$ajax("/headteacher/findGradeByCurrentUser",e).then(function(e){t.grades=e.data,t.gradeId=t.grades[0].index,t.gradeName=t.grades[1].name,t.gradeAllName=t.grades[1].name}).catch(function(){})},getCurrentGradeId:function(t){this.getClass(t),this.getSutdentGradeLists(t),this.getEditStudentsLists()},getClass:function(t){var e=this,a={schoolId:this.schoolId,gradeId:t};this.$ajax("/findClassByGradeIdAndSchoolId",a).then(function(t){e.classes=t.data,e.classId=e.classes[0].index,e.className=e.classes[0].name,e.getHeadTeacher(e.classId)}).catch(function(){})},getCurrentClassId:function(t){this.currentPage=1,this.currentClassId=t,this.getSutdentClassLists(this.currentClassId,1),this.getHeadTeacher(this.currentClassId)},getSutdentClassLists:function(t,e){var a=this;this.fullscreenLoading=!0;var s={schoolId:this.schoolId,classId:t,pageSize:10,pageNumber:e};this.$ajax("/findStudentByClassIdAndSchoolId",s).then(function(t){200==t.code?(a.studentClassListsData=t.data.resultList,a.total=t.data.total,a.fullscreenLoading=!1):(a.studentClassListsData=[],a.total=0,a.fullscreenLoading=!1)}).catch(function(){})},getCurrentRowInfo:function(t,e,a,s){this.currentRowInfo=t},changeStudensState:function(t){var e=this,a={id:this.currentRowInfo.id,state:t};this.$ajax("/changeStudentState",a).then(function(t){200==t.code&&(e.$message({message:"状态修改成功",type:"success"}),e.getSutdentClassLists(e.currentClassId,e.currentPage))}).catch(function(){})},getHeadTeacher:function(t){var e=this,a={classId:t};this.$ajax("/findHeadTeacherByClassId",a).then(function(t){"success"==t.message?(e.headTeacher=t.data,e.isHeadTeacher=!0):e.isHeadTeacher=!1}).catch(function(){})},studentRestPwd:function(t,e){var a=this;this.$confirm("是否要重置密码为学籍号后六位?","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var t={id:e.id};a.$ajax("/password/reset",t).then(function(t){200==t.code&&(a.$message({message:"删除成功",type:"success"}),a.getSutdentClassLists(a.currentClassId,a.currentPage))})}).catch(function(){})},studentDelete:function(t,e){var a=this;this.$confirm("确定要删除选中学生吗?","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var t={id:e.id};a.$ajax("/teacher/delOneStudent",t).then(function(t){200==t.code&&(a.$message({message:"删除成功",type:"success"}),a.getSutdentClassLists(a.currentClassId,a.currentPage))})}).catch(function(){})},manageClass:function(){this.dialogVisible=!0},paginationCurrentChange:function(t){var e=this;this.fullscreenLoading=!0,this.currentPage=t;var a={schoolId:this.schoolId,classId:this.currentClassId,pageSize:10,pageNumber:this.currentPage};this.$ajax("/findStudentByClassIdAndSchoolId",a).then(function(t){e.studentClassListsData=t.data.resultList,e.fullscreenLoading=!1}).catch(function(){})},gradesPaginationCurrentChange:function(t){var e=this,a={schoolId:1921,gradeCode:9,pageSize:10,currentPage:t};this.$ajax("/headteacher/findGradePoolByConditionAndPage",a).then(function(t){e.studentGradeListsData=t.data.rows}).catch(function(){})},gradesAllSelected:function(t){},gradesSelected:function(t){},getSutdentGradeLists:function(t){var e=this,a={schoolId:1921,gradeCode:9,pageSize:10,currentPage:1};this.$ajax("/headteacher/findGradePoolByConditionAndPage",a).then(function(t){e.studentGradeListsData=t.data.rows,e.gradesTotal=t.data.totalCount}).catch(function(){})},gradesSearch:function(t){var e=this;if(""==t)return!1;var a={schoolId:1921,gradeCode:9,pageSize:10,currentPage:1,keyWord:t};this.$ajax("/headteacher/findGradePoolByConditionAndPage",a).then(function(t){e.studentGradeListsData=t.data.rows,e.gradesTotal=t.data.totalCount}).catch(function(){})},gradesChange:function(t){0==t.length&&this.getSutdentGradeLists(this.gradeId)},getEditStudentsLists:function(){var t=this,e={classId:150};this.$ajax("/headteacher/findStudentByClassId",e).then(function(e){t.editStudentsListsData=e.data}).catch(function(){})},classesSearch:function(t){var e=this;if(""==t)return!1;var a={classId:150,keyWord:t};this.$ajax("/headteacher/findStudentByClassId",a).then(function(t){e.editStudentsListsData=t.data}).catch(function(){})},classesChange:function(t){0==t.length&&this.getEditStudentsLists()},studentsSelectionChange:function(t){this.addMultipleSelection=t,this.addMultipleSelection.length>0&&(this.addStudensState=!1,this.saveStudensState=!0),0==this.addMultipleSelection&&(this.addStudensState=!0),localStorage.setItem("addStudents",n()(this.addMultipleSelection))},addStudent:function(){var t=JSON.parse(localStorage.getItem("addStudents"));if(0==t.length)return!1;this.editStudentsListsData=_.concat(t,this.editStudentsListsData),this.studentGradeListsData=_.differenceWith(this.studentGradeListsData,t,_.isEqual),this.addStudensState=!0,this.saveStudensState=!1},removeStudentsSelectionChange:function(t){this.RemoveMultipleSelection=t,0==t.length&&(this.removeStudensState=!0),this.RemoveMultipleSelection.length>0&&(this.removeStudensState=!1,this.saveStudensState=!0),localStorage.setItem("removeStudents",n()(this.RemoveMultipleSelection))},addStudentsSelectionAll:function(){this.addStudensState=!!this.addStudensState,this.saveStudensState=!this.addStudensState},removeStudentsSelectionAll:function(){this.removeStudensState=!!this.removeStudensState,this.saveStudensState=!this.removeStudensState},removeStudent:function(){var t=JSON.parse(localStorage.getItem("removeStudents"));if(!(t.length>0))return!1;this.studentGradeListsData=_.concat(t,this.studentGradeListsData),this.editStudentsListsData=_.differenceWith(this.editStudentsListsData,t,_.isEqual),this.removeStudensState=!0,this.saveStudensState=!1},saveStudents:function(){var t=this,e=this.editStudentsListsData.map(function(t){return t.sid}).toString(),a={classId:150,sids:e};this.$ajax("/headteacher/saveUpgradeStudent",a).then(function(e){200==e.code&&(t.$message({message:"保存成功",type:"success"}),t.dialogVisible=!1,t.editStudentsListsData(),localStorage.removeItem("addStudents"),localStorage.removeItem("removeStudents"))}).catch(function(){})}}}},280:function(t,e,a){e=t.exports=a(182)(),e.push([t.i,".studentMgt-filter .classes,.studentMgt-header{margin:10px 0}.pagination{margin-top:10px}.studentMgt-body-title{display:-webkit-box;display:-ms-flexbox;display:flex}.studentMgt-body-title .item:first-child{margin-right:20px}.studentMgt-body-table,.transfer-data{margin-top:10px}.transfer-data{display:-webkit-box;display:-ms-flexbox;display:flex}.transfer-data .el-table__body-wrapper{height:300px;overflow-x:hidden}.transfer-data .transfer-data-left,.transfer-data .transfer-data-right{width:420px}.transfer-data-header .title{margin:10px 0}.transfer-data-header .el-select{display:inline-block;width:120px}.transfer-data-header .el-input{margin-top:10px}.transfer-data-operation{width:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.transfer-data-operation .el-button{margin:10px 0}.transfer-data-body{margin-top:10px}.el-table__empty-block{overflow:hidden}.el-table__empty-text{white-space:nowrap}.el-button--primary a{color:#fff}","",{version:3,sources:["E:/works/platform/yitai-educational/src/main/webapp/src/pages/front/schoolRollFiler/studentManagement.vue"],names:[],mappings:"AAIA,+CACE,aAAe,CAChB,AACD,YACE,eAAiB,CAClB,AACD,uBACE,oBAAqB,AACrB,oBAAqB,AACrB,YAAc,CACf,AACD,yCACE,iBAAmB,CACpB,AAID,sCAFE,eAAiB,CAOlB,AALD,eACE,oBAAoB,AACpB,oBAAoB,AACpB,YAAa,CAEd,AACD,uCACE,aAAc,AACd,iBAAmB,CACpB,AACD,uEAEE,WAAa,CACd,AACD,6BACE,aAAe,CAChB,AACD,iCACE,qBAAsB,AACtB,WAAa,CACd,AACD,gCACE,eAAiB,CAClB,AACD,yBACE,YAAa,AACb,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,4BAA6B,AAC7B,6BAA8B,AAC1B,0BAA2B,AACvB,sBAAuB,AAC/B,yBAA0B,AACtB,sBAAuB,AACnB,mBAAoB,AAC5B,wBAAyB,AACrB,qBAAsB,AAClB,sBAAwB,CACjC,AACD,oCACE,aAAe,CAChB,AACD,oBACE,eAAiB,CAClB,AACD,uBACE,eAAiB,CAClB,AACD,sBACE,kBAAoB,CACrB,AACD,sBACE,UAAY,CACb",file:"studentManagement.vue",sourcesContent:["\n.studentMgt-header{\n  margin: 10px 0;\n}\n.studentMgt-filter .classes{\n  margin: 10px 0;\n}\n.pagination{\n  margin-top: 10px;\n}\n.studentMgt-body-title{\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.studentMgt-body-title .item:first-child{\n  margin-right: 20px;\n}\n.studentMgt-body-table{\n  margin-top: 10px;\n}\n.transfer-data {\n  display:-webkit-box;\n  display:-ms-flexbox;\n  display:flex;\n  margin-top: 10px;\n}\n.transfer-data .el-table__body-wrapper{\n  height: 300px;\n  overflow-x: hidden;\n}\n.transfer-data .transfer-data-left,\n.transfer-data .transfer-data-right{\n  width: 420px;\n}\n.transfer-data-header .title{\n  margin: 10px 0;\n}\n.transfer-data-header .el-select{\n  display: inline-block;\n  width: 120px;\n}\n.transfer-data-header .el-input{\n  margin-top: 10px;\n}\n.transfer-data-operation{\n  width: 100px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.transfer-data-operation .el-button{\n  margin: 10px 0;\n}\n.transfer-data-body{\n  margin-top: 10px;\n}\n.el-table__empty-block{\n  overflow: hidden;\n}\n.el-table__empty-text {\n  white-space: nowrap;\n}\n.el-button--primary a{\n  color: #fff;\n}\n"],sourceRoot:""}])},318:function(t,e,a){var s=a(280);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(183)("38a09b38",s,!0)},361:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"studentManagement",attrs:{"element-loading-text":"页面加载中..."}},[a("div",{staticClass:"studentMgt-header"},[a("el-button",{attrs:{type:"primary"}},[a("router-link",{attrs:{to:"editstudent"}},[t._v(" 新建学生 ")])],1),t._v(" "),a("el-button",{attrs:{type:"primary"}},[a("router-link",{attrs:{to:"editstudent"}},[t._v("批量导入学生")])],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.manageClass}},[t._v("分班")]),t._v(" "),a("el-button",{attrs:{type:"primary"}},[t._v("删除学生")])],1),t._v(" "),a("div",{staticClass:"studentMgt-filter"},[a("div",{staticClass:"grades"},[a("el-radio-group",{on:{change:function(e){t.getCurrentGradeId(t.gradeId)}},model:{value:t.gradeId,callback:function(e){t.gradeId=e},expression:"gradeId"}},t._l(t.grades,function(e,s){return a("el-radio-button",{key:s,attrs:{label:e.index}},[t._v(" "+t._s(e.name)+" ")])}))],1),t._v(" "),a("div",{staticClass:"classes"},[a("el-radio-group",{on:{change:function(e){t.getCurrentClassId(t.classId)}},model:{value:t.classId,callback:function(e){t.classId=e},expression:"classId"}},t._l(t.classes,function(e,s){return a("el-radio-button",{key:s,attrs:{label:e.index}},[t._v(" "+t._s(e.name)+" ")])}))],1)]),t._v(" "),a("div",{staticClass:"studentMgt-body"},[a("div",{staticClass:"studentMgt-body-title"},[t.isHeadTeacher?t._e():a("p",[t._v(" 该班级暂无班主任 ")]),t._v(" "),t.isHeadTeacher?[a("h4",{staticClass:"item"},[t._v(" 班主任："+t._s(t.headTeacher.name))]),t._v(" "),a("h4",{staticClass:"item"},[t._v("手机号码："+t._s(t.headTeacher.phone))])]:t._e()],2),t._v(" "),a("div",{staticClass:"studentMgt-body-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.studentClassListsData},on:{"row-click":t.getCurrentRowInfo}},[a("el-table-column",{attrs:{type:"selection",width:"30"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",width:"80"},scopedSlots:t._u([["default",function(e){return[1==e.row.sex?a("span",[t._v("\n              男\n            ")]):t._e(),t._v(" "),2==e.row.sex?a("span",[t._v("\n              女\n            ")]):t._e()]}]])}),t._v(" "),a("el-table-column",{attrs:{prop:"nation",label:"民族"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sid",label:"学籍号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"schoolYear",label:"入学年份"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([["default",function(e){return[a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.changeStudensState}},[a("span",{staticClass:"el-dropdown-link"},[0==e.row.state?a("b",[t._v("正常")]):1==e.row.state?a("b",[t._v(" 禁用")]):2==e.row.state?a("b",[t._v("休学")]):a("b",[t._v("离校")]),t._v(" "),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"0"}},[t._v("正常")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"1"}},[t._v("禁用")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"2"}},[t._v("休学")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"3"}},[t._v("离校")])],1)],1)]}]])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"280"},scopedSlots:t._u([["default",function(e){return[a("el-button",{attrs:{type:"primary",size:"small"}},[a("router-link",{attrs:{to:{name:"editstudent",params:{id:e.row.id,type:"detail",gradeId:t.gradeId,classId:t.classId}}}},[t._v("查看")])],1),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"}},[a("router-link",{attrs:{to:{name:"editstudent",params:{id:e.row.id,type:"edit",gradeId:t.gradeId,classId:t.classId}}}},[t._v("编辑")])],1),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){t.studentRestPwd(e.$index,e.row)}}},[t._v("重置密码")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){t.studentDelete(e.$index,e.row)}}},[t._v("删除")])]}]])})],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"page-size":10,layout:"prev, pager, next, jumper",total:t.total,"current-page":t.currentPage},on:{"current-change":t.paginationCurrentChange}})],1)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"分班管理","close-on-click-modal":!1,size:"small"},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[a("div",{staticClass:"transfer-data"},[a("div",{staticClass:"transfer-data-left"},[a("div",{staticClass:"transfer-data-header"},[a("h2",{staticClass:"title"},[t._v("年级池")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){t.gradesAllSelected(t.gradeAllName)}},model:{value:t.gradeAllName,callback:function(e){t.gradeAllName=e},expression:"gradeAllName"}},t._l(t.grades,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.index,disabled:0==e}})})),t._v(" "),a("el-input",{attrs:{placeholder:"姓名模糊筛选"},on:{change:function(e){t.gradesChange(t.gradesSearchText)}},model:{value:t.gradesSearchText,callback:function(e){t.gradesSearchText=e},expression:"gradesSearchText"}},[a("el-button",{attrs:{icon:"search"},on:{click:function(e){t.gradesSearch(t.gradesSearchText)}},slot:"append"})],1)],1),t._v(" "),a("div",{staticClass:"transfer-data-body"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.studentGradeListsData,"empty-text":"请通过新增学生或者批量导入学生的方式维护班级学生"},on:{"selection-change":t.studentsSelectionChange,"select-all":t.addStudentsSelectionAll}},[a("el-table-column",{attrs:{type:"selection",width:"30"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sid",label:"学籍号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"className",label:"上学年年级班级"}})],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"page-size":10,layout:"prev, pager, next, jumper",total:t.gradesTotal},on:{"current-change":t.gradesPaginationCurrentChange}})],1)],1)]),t._v(" "),a("div",{staticClass:"transfer-data-operation"},[a("el-button",{attrs:{type:"primary",icon:"arrow-right",disabled:t.addStudensState},on:{click:t.addStudent}},[t._v("添加")]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"arrow-left",disabled:t.removeStudensState},on:{click:t.removeStudent}},[t._v("移除")])],1),t._v(" "),a("div",{staticClass:"transfer-data-right"},[a("div",{staticClass:"transfer-data-header"},[a("h2",{staticClass:"title"},[t._v("所选班级")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){t.gradesSelected(t.gradeName)}},model:{value:t.gradeName,callback:function(e){t.gradeName=e},expression:"gradeName"}},t._l(t.grades,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.index,disabled:0==e}})})),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.className,callback:function(e){t.className=e},expression:"className"}},t._l(t.classes,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-input",{attrs:{placeholder:"姓名模糊筛选"},on:{change:t.classesChange},model:{value:t.classesSearchText,callback:function(e){t.classesSearchText=e},expression:"classesSearchText"}},[a("el-button",{attrs:{icon:"search"},on:{click:function(e){t.classesSearch(t.classesSearchText)}},slot:"append"})],1)],1),t._v(" "),a("div",{staticClass:"transfer-data-body"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.editStudentsListsData},on:{"selection-change":t.removeStudentsSelectionChange,"select-all":t.removeStudentsSelectionAll}},[a("el-table-column",{attrs:{type:"selection",width:"30"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sid",label:"学籍号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名"}})],1)],1)])]),t._v(" "),a("span",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"success",disabled:t.saveStudensState},on:{click:t.saveStudents}},[t._v("添 加")])],1)])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=16.99a672e01b5c629d2f9c.js.map