webpackJsonp([35],{189:function(e,t,n){n(346);var s=n(73)(n(243),n(392),null,null);e.exports=s.exports},243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"admin",data:function(){return{value:"",fullscreenLoading:!0,orgInfoForm:{childrenName:"",address:"",schoolNum:"",note:""},province:[],city:[],county:[],selectedProvince:"",selectedCity:"",selectedCounty:"",orgInfoRules:{childrenName:[{required:!0,message:"请输入机构名称",trigger:"blur"},{pattern:/^[\u4E00-\u9FA5]+$/,message:"用户名只能为中文"},{min:6,max:30,message:"长度在 6 到 30 个字符"}],note:[{required:!0,message:"请输入描述信息",trigger:"change"},{min:0,max:200,message:"长度在 0 到 200 个汉字"}]},orgListsData:[],searchText:"",defaultProps:{children:"childrens",label:"name"},orgInfoId:"110106",chooseOrgId:"",type:"",pId:"",address:"",name:"",isEditing:!1,orgUsers:[],orgUserTotal:0,orgUserFormAdd:{name:"",phone:""},currentInfo:"",orgUserStutas:"",orgUserFormEdit:{name:"",phone:""},orgUserAddRules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"},{pattern:/^[\u4E00-\u9FA5]+$/,message:"用户名只能为中文",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个汉字",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"请输入11位手机号",trigger:"blur"}]},dialogVisibleAdd:!1,dialogVisibleEdit:!1,multipleSelection:[]}},mounted:function(){this.getOrgTree(),this.getOrgUserLists(),this.getAreaTree()},methods:{getNodeId:function(e){console.log(this.orgInfoId),this.getOrgInfo(this.orgInfoId),this.chooseOrg()},getOrgInfo:function(e){var t=this;this.$ajax("/eduadmin/orgInfo",{id:this.orgInfoId}).then(function(e){t.orgInfoForm=e.data})},getOrgTree:function(){var e=this;this.fullscreenLoading=!0;var t={userId:1};this.$ajax("/eduadmin/getOrgTree",t).then(function(t){e.orgListsData=t.data,e.getOrgInfo(e.orgListsData[0].id),e.fullscreenLoading=!1})},filterNode:function(e,t){return!e||(console.log(t.name),-1!==t.name.indexOf(e))},editOrgInfoForm:function(){this.isEditing=!0},cancelOrgInfoForm:function(){this.isEditing=!1,this.getOrgInfo(this.orgInfoId)},getAreaTree:function(){var e=this;this.$ajax("/org/getTree").then(function(t){e.province=t.data}).catch(function(){})},provinceChange:function(e){var t=this;this.selectedProvince=e;var n={parentId:this.selectedProvince};this.$ajax("/org/getChildren",n).then(function(e){t.city=e.data}).catch(function(){})},cityChange:function(e){var t=this;this.selectedCity=e;var n={parentId:this.selectedCity};this.$ajax("/org/getChildren",n).then(function(e){t.county=e.data}).catch(function(){})},countyChange:function(e){this.selectedCounty=e},saveOrgInfoForm:function(){var e=this,t={id:this.orgInfoId,childrenName:this.orgInfoForm.childrenName,orgId:this.selectedCounty||this.selectedCity||this.selectedProvince,address:this.orgInfoForm.address,note:this.orgInfoForm.note};this.$ajax("/eduadmin/editOrg",t).then(function(t){200==t.code?(e.$message({type:"success",message:"保存成功!"}),e.isEditing=!1):(e.$message({type:"error",message:t.message}),e.isEditing=!1)})},getOrgUserLists:function(){var e=this;this.$ajax("/eduadmin/orgUserList",{orgId:this.orgInfoId}).then(function(t){e.orgUsers=t.data,e.orgUserTotal=e.orgUsers.length})},addOrgUser:function(){this.orgUserFormAdd={},this.dialogVisibleAdd=!0},orgUserFormAddData:function(){var e=this;this.$refs.orgUserFormAdd.validate(function(t){if(!t)return!1;var n={orgId:e.orgInfoId,name:e.orgUserFormAdd.name,phone:e.orgUserFormAdd.phone};e.$ajax("/eduadmin/addOrgUser",n).then(function(t){200==t.code?(e.$message({type:"success",message:"添加成功!"}),e.dialogVisibleAdd=!1,e.getOrgUserLists()):(e.$message({type:"error",message:t.message}),e.dialogVisibleAdd=!1)})})},getOrgUserCurrentInfo:function(e,t,n,s){this.currentInfo=e},getOrgUserSelectState:function(e){var t=this,n={orgId:this.orgInfoId,userId:this.currentInfo.id,state:e};this.$ajax("/eduadmin/changeOrgUserStatus",n).then(function(e){200==e.code&&(t.$message({message:"状态修改成功",type:"success"}),t.getOrgUserLists())}).catch(function(){})},orgUsersEdit:function(e,t){this.dialogVisibleEdit=!0,this.orgUserFormEdit.name=t.name,this.orgUserFormEdit.phone=t.phone},orgUserFormEditData:function(){var e=this,t={orgId:this.orgInfoId,userId:this.currentInfo.id,name:this.orgUserFormEdit.name,phone:this.orgUserFormEdit.phone};this.$ajax("/eduadmin/editOrgUser",t).then(function(t){200==t.code&&(e.dialogVisibleEdit=!1,e.$message({message:"保存成功",type:"success"})),e.getOrgUserLists()}).catch(function(){})},orgUsersRestPwd:function(e,t){var n=this;console.log(t),this.$confirm("是否要重置密码为手机号码后六位?","提示",{type:"warning",confirmButtonText:"重置",cancelButtonText:"取消"}).then(function(){var e={phone:t.phone};n.$ajax("/password/reset",e).then(function(e){200==e.code&&n.$message({message:"重置成功",type:"success"})})}).catch(function(){})},orgUsersDelete:function(e,t){var n=this;console.log(e,t),this.$confirm("确定要删除选中教师吗?","提示",{type:"warning",confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){var e={userId:t.id,orgId:n.orgInfoId};n.$ajax("/eduadmin/delOrgUser",e).then(function(e){200==e.code&&n.$message({message:"删除成功",type:"success"}),n.getOrgUserLists()})}).catch(function(){})},orgUsersSelectionChange:function(e){console.log(1),this.multipleSelection=e},orgUsersBatchDelete:function(e,t){var n=this,s=this.multipleSelection.map(function(e){return e.id}).toString();this.$confirm("确定要删除选中教师吗?","提示",{type:"warning",confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){var e={userId:s,orgId:n.orgInfoId};n.$ajax("/eduadmin/delOrgUser",e).then(function(e){200==e.code&&n.$message({message:"删除成功",type:"success"}),n.getOrgUserLists()})}).catch(function(){})},paginationCurrentChange:function(e){}},watch:{searchText:function(e){this.$refs.orgLists.filter(e)}}}},308:function(e,t,n){t=e.exports=n(182)(),t.push([e.i,".admin{margin-top:15px;height:100%;text-align:left;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.menus{width:200px;border:1px solid #20a0ff}.menus-head{background:#20a0ff;color:#fff;padding:10px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.menus-head .title{font-size:14px}.menus-head .add-btn{color:#fff;border:1px solid #fff;font-size:12px;padding:2px}.seach-bar{padding:10px}.seach-bar input{height:30px;width:100%;border:1px solid #20a0ff}.main-content{width:800px}.el-tabs__active-bar{top:0}.el-tree-node.is-current{color:#20a0ff}.tabs-header{margin-bottom:10px}.text-left{text-align:left}.text-right{text-align:right}.space-between{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.space-around,.space-between{display:-webkit-box;display:-ms-flexbox;display:flex}.space-around{-ms-flex-pack:distribute;justify-content:space-around}.tabs-header .editor{padding:10px;display:block}.edit .item-text{display:none}.edit.editing .item-text{display:block;width:200px}.edit.editing p{display:none}.edit.editing .item-text.el-select{display:inline-block}.edit .item-text .el-textarea{margin-top:22px;width:300px;display:block}.pagination{margin-top:30px}b{font-weight:400}.details-address{margin-top:10px}","",{version:3,sources:["E:/works/platform/yitai-educational/src/main/webapp/src/pages/front/admin/admin.vue"],names:[],mappings:"AACA,OACE,gBAAiB,AACjB,YAAa,AACb,gBAAiB,AACjB,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,yBAA0B,AACtB,sBAAuB,AACnB,6BAA+B,CACxC,AACD,OACE,YAAa,AACb,wBAA0B,CAC3B,AACD,YACE,mBAAoB,AACpB,WAAY,AACZ,aAAc,AACd,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,yBAA0B,AACtB,sBAAuB,AACnB,6BAA+B,CACxC,AACD,mBACE,cAAgB,CACjB,AACD,qBACE,WAAW,AACX,sBAAuB,AACvB,eAAgB,AAChB,WAAa,CACd,AACD,WACE,YAAc,CACf,AACD,iBACE,YAAa,AACb,WAAY,AACZ,wBAA0B,CAC3B,AACD,cACE,WAAa,CACd,AAOD,qBACE,KAAO,CACR,AACD,yBACE,aAAe,CAChB,AACD,aAEE,kBAAoB,CACrB,AACD,WACE,eAAiB,CAClB,AACD,YACE,gBAAkB,CACnB,AACD,eAIE,yBAA0B,AACtB,sBAAuB,AACnB,6BAA+B,CACxC,AACD,6BAPE,oBAAqB,AACrB,oBAAqB,AACrB,YAAc,CAWf,AAND,cAIE,yBAA0B,AACtB,4BAA8B,CACnC,AACD,qBACE,aAAc,AACd,aAAe,CAChB,AAMD,iBACE,YAAc,CAEf,AACD,yBACE,cAAe,AACf,WAAa,CACd,AACD,gBACE,YAAc,CACf,AACD,mCACE,oBAAsB,CACvB,AACD,8BACE,gBAAiB,AACjB,YAAa,AACb,aAAe,CAChB,AACD,YACE,eAAiB,CAClB,AACD,EACE,eAAoB,CACrB,AACD,iBACE,eAAiB,CAClB",file:"admin.vue",sourcesContent:["\n.admin{\n  margin-top: 15px;\n  height: 100%;\n  text-align: left;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n.menus{\n  width: 200px;\n  border: 1px solid #20A0FF;\n}\n.menus-head{\n  background: #20A0FF;\n  color: #fff;\n  padding: 10px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n.menus-head .title{\n  font-size: 14px;\n}\n.menus-head .add-btn{\n  color:#fff;\n  border: 1px solid #fff;\n  font-size: 12px;\n  padding: 2px;\n}\n.seach-bar{\n  padding: 10px;\n}\n.seach-bar input{\n  height: 30px;\n  width: 100%;\n  border: 1px solid #20A0FF;\n}\n.main-content{\n  width: 800px;\n}\n/* .tabs .el-tabs--border-card>.el-tabs__header .el-tabs__item{\n  border-top: 3px solid;\n}\n.tabs .el-tabs--border-card>.el-tabs__header .el-tabs__item.is-active{\n  border-top: 3px solid;\n} */\n.el-tabs__active-bar{\n  top: 0;\n}\n.el-tree-node.is-current{\n  color: #20A0FF;\n}\n.tabs-header{\n\n  margin-bottom: 10px;\n}\n.text-left {\n  text-align: left;\n}\n.text-right {\n  text-align: right;\n}\n.space-between{\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n.space-around{\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-pack: distribute;\n      justify-content: space-around;\n}\n.tabs-header .editor{\n  padding: 10px;\n  display: block;\n}\n\n/* .el-form-item.is-required .el-form-item__label:before{\n  content: '•';\n  color: #999;\n} */\n.edit .item-text{\n  display: none;\n  /* display: inline-block; */\n}\n.edit.editing .item-text{\n  display: block;\n  width: 200px;\n}\n.edit.editing p{\n  display: none;\n}\n.edit.editing .item-text.el-select{\n  display: inline-block;\n}\n.edit .item-text .el-textarea{\n  margin-top: 22px;\n  width: 300px;\n  display: block;\n}\n.pagination{\n  margin-top: 30px;\n}\nb{\n  font-weight: normal;\n}\n.details-address{\n  margin-top: 10px;\n}\n"],sourceRoot:""}])},346:function(e,t,n){var s=n(308);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);n(183)("26483156",s,!0)},392:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"admin"},[n("div",{staticClass:"menus"},[e._m(0),e._v(" "),n("div",{staticClass:"seach-bar"},[n("el-input",{attrs:{placeholder:"请输入机构名称",icon:"search"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),e._v(" "),n("el-tree",{ref:"orgLists",attrs:{data:e.orgListsData,props:e.defaultProps,accordion:"","filter-node-method":e.filterNode},on:{"node-click":e.getNodeId}})],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"main-content",attrs:{"element-loading-text":"页面加载中..."}},[n("div",{staticClass:"tabs"},[n("el-tabs",[n("el-tab-pane",{attrs:{label:"机构信息"}},[n("div",{staticClass:"tabs-header text-right"},[e.isEditing?e._e():n("el-button",{attrs:{type:"success",icon:"edit"},on:{click:e.editOrgInfoForm}},[e._v("编辑")]),e._v(" "),e.isEditing?n("el-button",{attrs:{type:"success",icon:"edit"},on:{click:e.cancelOrgInfoForm}},[e._v("取消")]):e._e(),e._v(" "),e.isEditing?n("el-button",{attrs:{type:"success",icon:"edit"},on:{click:e.saveOrgInfoForm}},[e._v("保存")]):e._e()],1),e._v(" "),n("div",{staticClass:"tabs-body"},[n("el-form",{ref:"form",staticClass:"edit",class:[{editing:e.isEditing}],attrs:{model:e.orgInfoForm,rules:e.orgInfoRules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"机构名称：",prop:"childrenName"}},[n("el-input",{staticClass:"item-text",model:{value:e.orgInfoForm.childrenName,callback:function(t){e.orgInfoForm.childrenName=t},expression:"orgInfoForm.childrenName"}}),e._v(" "),n("p",[e._v(" "+e._s(e.orgInfoForm.childrenName)+" ")])],1),e._v(" "),n("el-form-item",{attrs:{label:"所在地址：",prop:"address"}},[n("el-select",{staticClass:"item-text",attrs:{placeholder:"请选择省"},on:{change:e.provinceChange},model:{value:e.selectedProvince,callback:function(t){e.selectedProvince=t},expression:"selectedProvince"}},e._l(e.province,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),0!=e.city.length?n("el-select",{staticClass:"item-text",attrs:{placeholder:"请选择市"},on:{change:e.cityChange},model:{value:e.selectedCity,callback:function(t){e.selectedCity=t},expression:"selectedCity"}},e._l(e.city,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})):e._e(),e._v(" "),0!=e.county.length?n("el-select",{staticClass:"item-text",attrs:{placeholder:"请选择区/县"},on:{change:e.countyChange},model:{value:e.selectedCounty,callback:function(t){e.selectedCounty=t},expression:"selectedCounty"}},e._l(e.county,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})):e._e(),e._v(" "),n("div",{staticClass:"item-text"},[n("el-input",{attrs:{type:"textarea"},model:{value:e.orgInfoForm.address,callback:function(t){e.orgInfoForm.address=t},expression:"orgInfoForm.address"}})],1),e._v(" "),n("p",[e._v(" "+e._s(e.orgInfoForm.address)+" ")])],1),e._v(" "),n("el-form-item",{attrs:{label:"学校数量：",prop:"schoolNum"}},[n("span",[e._v(" "+e._s(e.orgInfoForm.schoolNum)+" ")]),e._v(" "),n("a",{attrs:{href:"javascript:;"}},[e._v("学校列表")])]),e._v(" "),n("el-form-item",{attrs:{label:"描述：",prop:"note"}},[n("el-input",{staticClass:"item-text",attrs:{type:"textarea",prop:"note"},model:{value:e.orgInfoForm.note,callback:function(t){e.orgInfoForm.note=t},expression:"orgInfoForm.note"}}),e._v(" "),n("p",[e._v(" "+e._s(e.orgInfoForm.note)+" ")])],1)],1)],1)])],1),e._v(" "),n("el-tabs",[n("el-tab-pane",{attrs:{label:"机构人员"}},[n("div",{staticClass:"tabs-header space-between"},[n("el-button",{attrs:{type:"success",icon:"plus"},on:{click:e.addOrgUser}},[e._v("新建人员")])],1),e._v(" "),n("div",{staticClass:"tabs-body"},[n("el-table",{attrs:{data:e.orgUsers,border:"","tooltip-effect":"dark"},on:{"cell-click":e.getOrgUserCurrentInfo,"selection-change":e.orgUsersSelectionChange}},[n("el-table-column",{attrs:{prop:"name",label:"姓名",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{prop:"phone",label:"手机号",width:"150"}}),e._v(" "),n("el-table-column",{attrs:{prop:"state",label:"状态",width:"150"},scopedSlots:e._u([["default",function(t){return[n("el-dropdown",{attrs:{trigger:"click"},on:{command:e.getOrgUserSelectState}},[n("span",{staticClass:"el-dropdown-link"},[1==t.row.state?n("b",[e._v("正常")]):n("b",[e._v("禁用")]),e._v(" "),n("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),e._v(" "),n("el-dropdown-menu",{slot:"dropdown"},[1==t.row.state?n("el-dropdown-item",{attrs:{command:"0"}},[e._v("禁用")]):e._e(),e._v(" "),0==t.row.state?n("el-dropdown-item",{attrs:{command:"1"}},[e._v("正常")]):e._e()],1)],1)]}]])}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"320"},scopedSlots:e._u([["default",function(t){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){e.orgUsersEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){e.orgUsersRestPwd(t.$index,t.row)}}},[e._v("重置密码")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){e.orgUsersDelete(t.$index,t.row)}}},[e._v("删除")])]}]])})],1),e._v(" "),n("div",{staticClass:"pagination text-right"}),e._v(" "),n("el-dialog",{attrs:{title:"新建机构人员","close-on-click-modal":!1,size:"tiny"},model:{value:e.dialogVisibleAdd,callback:function(t){e.dialogVisibleAdd=t},expression:"dialogVisibleAdd"}},[n("el-form",{ref:"orgUserFormAdd",attrs:{model:e.orgUserFormAdd,rules:e.orgUserAddRules,"label-width":"90px"}},[n("el-form-item",{attrs:{label:"姓名：",prop:"name"}},[n("el-input",{model:{value:e.orgUserFormAdd.name,callback:function(t){e.orgUserFormAdd.name="string"==typeof t?t.trim():t},expression:"orgUserFormAdd.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"手机号：",prop:"phone"}},[n("el-input",{model:{value:e.orgUserFormAdd.phone,callback:function(t){e.orgUserFormAdd.phone="string"==typeof t?t.trim():t},expression:"orgUserFormAdd.phone"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",slot:"footer"},[n("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogVisibleAdd=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"success"},on:{click:function(t){e.orgUserFormAddData()}}},[e._v("添 加")])],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"编辑机构人员","close-on-click-modal":!1,size:"tiny"},model:{value:e.dialogVisibleEdit,callback:function(t){e.dialogVisibleEdit=t},expression:"dialogVisibleEdit"}},[n("el-form",{ref:"orgUserFormEdit",attrs:{model:e.orgUserFormEdit,rules:e.orgUserAddRules,"label-width":"90px"}},[n("el-form-item",{attrs:{label:"姓名：",prop:"name"}},[n("el-input",{model:{value:e.orgUserFormEdit.name,callback:function(t){e.orgUserFormEdit.name="string"==typeof t?t.trim():t},expression:"orgUserFormEdit.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"手机号：",prop:"phone"}},[n("el-input",{model:{value:e.orgUserFormEdit.phone,callback:function(t){e.orgUserFormEdit.phone="string"==typeof t?t.trim():t},expression:"orgUserFormEdit.phone"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",slot:"footer"},[n("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogVisibleEdit=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"success"},on:{click:function(t){e.orgUserFormEditData()}}},[e._v("保 存")])],1)],1)],1)])],1)],1)])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menus-head"},[n("h4",{staticClass:"title"},[e._v("机构列表")])])}]}}});
//# sourceMappingURL=35.66842f10acc73d6e22e2.js.map